<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ES6 Modules - Complete Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .hero {
            text-align: center;
            padding: 60px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            margin-bottom: 40px;
            backdrop-filter: blur(10px);
        }

        .hero h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .hero p {
            font-size: 1.3em;
            color: rgba(255, 255, 255, 0.9);
            max-width: 600px;
            margin: 0 auto;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .card h3 {
            color: #764ba2;
            margin: 25px 0 15px 0;
            font-size: 1.3em;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            position: relative;
        }

        .code-block::before {
            content: attr(data-language);
            position: absolute;
            top: -12px;
            right: 15px;
            background: #667eea;
            color: white;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 0.8em;
        }

        .file-structure {
            background: #2d3748;
            color: #68d391;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .file-structure::before {
            content: "File Structure";
            position: absolute;
            top: -12px;
            right: 15px;
            background: #2d3748;
            color: white;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 0.8em;
        }

        .demo-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .demo-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }

        .output {
            background: #2d3748;
            color: #68d391;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
        }

        .highlight {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .best-practices {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .best-practices h3 {
            color: white;
            margin-bottom: 15px;
        }

        .best-practices ul {
            list-style: none;
            padding-left: 0;
        }

        .best-practices li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .best-practices li::before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #68d391;
            font-weight: bold;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .comparison-item {
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }

        .comparison-item.before {
            background: #fff5f5;
            border-color: #feb2b2;
        }

        .comparison-item.after {
            background: #f0fff4;
            border-color: #9ae6b4;
        }

        .comparison-item h4 {
            margin-bottom: 10px;
            color: #2d3748;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .tab {
            padding: 10px 20px;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 1em;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
            padding: 20px;
            background: white;
            border-radius: 0 8px 8px 8px;
        }

        .tab-content.active {
            display: block;
        }

        .module-diagram {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 20px 0;
        }

        .module-box {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            min-width: 120px;
        }

        .module-arrow {
            font-size: 2em;
            color: #667eea;
        }

        .bundler-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .bundler-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .bundler-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
        }

        .bundler-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }

            .hero h1 {
                font-size: 2.5em;
            }

            .comparison {
                grid-template-columns: 1fr;
            }

            .module-diagram {
                flex-direction: column;
            }

            .module-arrow {
                transform: rotate(90deg);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="hero">
            <h1>ES6 Modules</h1>
            <p>Master JavaScript modules: import/export, module systems, and modern application architecture</p>
        </div>

        <div class="content-grid">
            <div class="card">
                <h2>📦 Module Basics</h2>

                <h3>Export Syntax</h3>
                <div class="comparison">
                    <div class="comparison-item before">
                        <h4>CommonJS (Node.js)</h4>
                        <div class="code-block" data-language="JavaScript">
                            // math.js
                            function add(a, b) {
                            return a + b;
                            }

                            function subtract(a, b) {
                            return a - b;
                            }

                            module.exports = {
                            add,
                            subtract
                            };

                            // main.js
                            const { add, subtract } = require('./math');
                        </div>
                    </div>
                    <div class="comparison-item after">
                        <h4>ES6 Modules</h4>
                        <div class="code-block" data-language="JavaScript">
                            // math.js
                            export function add(a, b) {
                            return a + b;
                            }

                            export function subtract(a, b) {
                            return a - b;
                            }

                            // main.js
                            import { add, subtract } from './math.js';
                        </div>
                    </div>
                </div>

                <h3>Export Variations</h3>
                <div class="code-block" data-language="JavaScript">
                    // Named exports
                    export const PI = 3.14159;
                    export const E = 2.71828;

                    export function square(x) {
                    return x * x;
                    }

                    export class Calculator {
                    constructor() {
                    this.result = 0;
                    }

                    add(value) {
                    this.result += value;
                    return this;
                    }

                    subtract(value) {
                    this.result -= value;
                    return this;
                    }

                    getValue() {
                    return this.result;
                    }
                    }

                    // Export list
                    const user = { name: 'John', age: 30 };
                    const config = { debug: true };

                    export { user, config };

                    // Renamed exports
                    function internalFunction() {
                    return 'internal';
                    }

                    export { internalFunction as publicFunction };

                    // Re-exports
                    export { add, subtract } from './math.js';
                    export * from './utils.js';
                    export { default as Logger } from './logger.js';
                </div>

                <h3>Default Exports</h3>
                <div class="code-block" data-language="JavaScript">
                    // Default export - function
                    // utils.js
                    export default function formatDate(date) {
                    return date.toLocaleDateString();
                    }

                    // Default export - class
                    // user.js
                    export default class User {
                    constructor(name, email) {
                    this.name = name;
                    this.email = email;
                    }

                    getProfile() {
                    return `${this.name} (${this.email})`;
                    }
                    }

                    // Default export - object
                    // config.js
                    export default {
                    apiUrl: 'https://api.example.com',
                    timeout: 5000,
                    retries: 3
                    };

                    // Default export - value
                    // constants.js
                    export default 42;

                    // Mixed exports
                    // api.js
                    export default class ApiClient {
                    constructor(baseUrl) {
                    this.baseUrl = baseUrl;
                    }

                    async get(endpoint) {
                    // Implementation
                    }
                    }

                    export const API_VERSION = 'v1';
                    export const TIMEOUT = 30000;
                </div>

                <div class="demo-container">
                    <div class="demo-title">📦 Module Structure Demo</div>
                    <button onclick="showModuleStructure()">Show Module Structure</button>
                    <div id="structure-output" class="output" style="display: none;"></div>
                </div>
            </div>

            <div class="card">
                <h2>🔄 Import Syntax</h2>

                <h3>Import Variations</h3>
                <div class="code-block" data-language="JavaScript">
                    // Named imports
                    import { add, subtract, PI } from './math.js';

                    // Renamed imports
                    import { add as sum, subtract as diff } from './math.js';

                    // Default imports
                    import formatDate from './utils.js';
                    import User from './user.js';
                    import config from './config.js';

                    // Mixed imports
                    import ApiClient, { API_VERSION, TIMEOUT } from './api.js';

                    // Namespace imports
                    import * as MathUtils from './math.js';
                    console.log(MathUtils.add(5, 3));
                    console.log(MathUtils.PI);

                    // Dynamic imports
                    const mathModule = await import('./math.js');
                    const { add, subtract } = mathModule;

                    // Conditional imports
                    if (condition) {
                    const { heavyFunction } = await import('./heavy-module.js');
                    heavyFunction();
                    }

                    // Side-effect imports
                    import './polyfills.js';
                    import './global-styles.css';

                    // Import from node_modules
                    import express from 'express';
                    import { Router } from 'express';
                    import _ from 'lodash';
                    import { debounce, throttle } from 'lodash';

                    // Import with file extensions
                    import { helper } from './helper.js';
                    import data from './data.json';
                    import styles from './styles.css';

                    // Import from different directories
                    import { component } from '../components/index.js';
                    import { service } from '../../services/api.js';
                    import { util } from '@/utils/index.js'; // Alias
                </div>

                <h3>Module Resolution</h3>
                <div class="file-structure">
                    project/
                    ├── src/
                    │ ├── components/
                    │ │ ├── Button.js
                    │ │ ├── Modal.js
                    │ │ └── index.js
                    │ ├── services/
                    │ │ ├── api.js
                    │ │ ├── auth.js
                    │ │ └── index.js
                    │ ├── utils/
                    │ │ ├── helpers.js
                    │ │ ├── validators.js
                    │ │ └── index.js
                    │ ├── config/
                    │ │ ├── development.js
                    │ │ ├── production.js
                    │ │ └── index.js
                    │ └── main.js
                    ├── public/
                    │ └── index.html
                    ├── package.json
                    └── package-lock.json
                </div>

                <div class="code-block" data-language="JavaScript">
                    // Index files for clean imports
                    // src/components/index.js
                    export { default as Button } from './Button.js';
                    export { default as Modal } from './Modal.js';

                    // src/services/index.js
                    export { default as ApiService } from './api.js';
                    export { default as AuthService } from './auth.js';

                    // src/utils/index.js
                    export * from './helpers.js';
                    export * from './validators.js';

                    // Usage in main.js
                    import { Button, Modal } from './components/index.js';
                    import { ApiService, AuthService } from './services/index.js';
                    import { formatDate, validateEmail } from './utils/index.js';

                    // Barrel exports
                    // src/index.js
                    export * from './components/index.js';
                    export * from './services/index.js';
                    export * from './utils/index.js';
                    export { default as config } from './config/index.js';

                    // Clean imports from barrel
                    import { Button, Modal, ApiService, formatDate, config } from './src/index.js';
                </div>

                <div class="module-diagram">
                    <div class="module-box">
                        <strong>Module A</strong><br>
                        exports: {func1, func2}
                    </div>
                    <div class="module-arrow">→</div>
                    <div class="module-box">
                        <strong>Module B</strong><br>
                        imports: {func1, func2}
                    </div>
                    <div class="module-arrow">→</div>
                    <div class="module-box">
                        <strong>Bundle</strong><br>
                        Combined & optimized
                    </div>
                </div>

                <div class="demo-container">
                    <div class="demo-title">🔄 Import Examples Demo</div>
                    <button onclick="showImportExamples()">Show Import Examples</button>
                    <div id="import-output" class="output" style="display: none;"></div>
                </div>
            </div>

            <div class="card">
                <h2>⚡ Dynamic Imports</h2>

                <h3>Dynamic Import Syntax</h3>
                <div class="code-block" data-language="JavaScript">
                    // Basic dynamic import
                    async function loadModule() {
                    const module = await import('./math.js');
                    return module.add(5, 3);
                    }

                    // Dynamic import with destructuring
                    async function loadUtilities() {
                    const { formatDate, validateEmail } = await import('./utils.js');

                    console.log(formatDate(new Date()));
                    console.log(validateEmail('user@example.com'));
                    }

                    // Conditional loading
                    async function loadFeature(featureName) {
                    if (featureName === 'advanced') {
                    const { AdvancedFeature } = await import('./advanced-features.js');
                    return new AdvancedFeature();
                    } else {
                    const { BasicFeature } = await import('./basic-features.js');
                    return new BasicFeature();
                    }
                    }

                    // Dynamic import with error handling
                    async function safeImport(modulePath) {
                    try {
                    const module = await import(modulePath);
                    return module;
                    } catch (error) {
                    console.error(`Failed to load module: ${modulePath}`, error);
                    return null;
                    }
                    }

                    // Lazy loading for performance
                    class LazyLoader {
                    constructor() {
                    this.cache = new Map();
                    }

                    async loadModule(modulePath) {
                    if (this.cache.has(modulePath)) {
                    return this.cache.get(modulePath);
                    }

                    const module = await import(modulePath);
                    this.cache.set(modulePath, module);
                    return module;
                    }
                    }

                    const loader = new LazyLoader();

                    // User interaction triggered loading
                    document.getElementById('advanced-button').addEventListener('click', async () => {
                    const { AdvancedComponent } = await import('./advanced-component.js');
                    const component = new AdvancedComponent();
                    component.render();
                    });
                </div>

                <h3>Code Splitting Patterns</h3>
                <div class="code-block" data-language="JavaScript">
                    // Route-based code splitting
                    const routes = {
                    '/home': () => import('./pages/Home.js'),
                    '/about': () => import('./pages/About.js'),
                    '/contact': () => import('./pages/Contact.js'),
                    '/admin': () => import('./pages/Admin.js')
                    };

                    async function loadPage(path) {
                    const loader = routes[path];
                    if (!loader) {
                    throw new Error(`Route not found: ${path}`);
                    }

                    const module = await loader();
                    return module.default;
                    }

                    // Component-based code splitting
                    class ComponentLoader {
                    static async loadComponent(name) {
                    const componentMap = {
                    'DataTable': () => import('./components/DataTable.js'),
                    'Chart': () => import('./components/Chart.js'),
                    'Calendar': () => import('./components/Calendar.js'),
                    'FileUpload': () => import('./components/FileUpload.js')
                    };

                    const loader = componentMap[name];
                    if (!loader) {
                    throw new Error(`Component not found: ${name}`);
                    }

                    const module = await loader();
                    return module.default;
                    }
                    }

                    // Feature flag based loading
                    const featureFlags = {
                    newDashboard: true,
                    experimentalFeatures: false,
                    betaComponents: true
                    };

                    async function loadFeatures() {
                    const features = [];

                    if (featureFlags.newDashboard) {
                    const { NewDashboard } = await import('./features/NewDashboard.js');
                    features.push(new NewDashboard());
                    }

                    if (featureFlags.experimentalFeatures) {
                    const { ExperimentalFeatures } = await import('./features/Experimental.js');
                    features.push(new ExperimentalFeatures());
                    }

                    return features;
                    }

                    // Polyfill loading
                    async function loadPolyfills() {
                    const polyfills = [];

                    if (!('IntersectionObserver' in window)) {
                    polyfills.push(import('./polyfills/intersection-observer.js'));
                    }

                    if (!('fetch' in window)) {
                    polyfills.push(import('./polyfills/fetch.js'));
                    }

                    if (!('Promise' in window)) {
                    polyfills.push(import('./polyfills/promise.js'));
                    }

                    await Promise.all(polyfills);
                    }

                    // Progressive enhancement
                    class ProgressiveLoader {
                    static async enhanceElement(element) {
                    const enhancement = element.dataset.enhancement;

                    if (enhancement === 'dropdown') {
                    const { DropdownEnhancement } = await import('./enhancements/Dropdown.js');
                    new DropdownEnhancement(element);
                    } else if (enhancement === 'tooltip') {
                    const { TooltipEnhancement } = await import('./enhancements/Tooltip.js');
                    new TooltipEnhancement(element);
                    }
                    }
                    }

                    // Usage
                    document.querySelectorAll('[data-enhancement]').forEach(element => {
                    element.addEventListener('mouseenter', () => {
                    ProgressiveLoader.enhanceElement(element);
                    }, { once: true });
                    });
                </div>

                <h3>Module Federation</h3>
                <div class="code-block" data-language="JavaScript">
                    // Micro-frontend architecture
                    class MicroFrontendLoader {
                    constructor() {
                    this.remotes = new Map();
                    }

                    registerRemote(name, url) {
                    this.remotes.set(name, url);
                    }

                    async loadRemoteModule(remoteName, moduleName) {
                    const remoteUrl = this.remotes.get(remoteName);
                    if (!remoteUrl) {
                    throw new Error(`Remote not found: ${remoteName}`);
                    }

                    // Load remote container
                    const container = await import(remoteUrl);

                    // Get the factory for the specific module
                    const factory = await container.get(moduleName);

                    // Create the module
                    const module = factory();

                    return module;
                    }
                    }

                    // Usage
                    const loader = new MicroFrontendLoader();
                    loader.registerRemote('userService', 'https://user-service.example.com/remoteEntry.js');
                    loader.registerRemote('paymentService', 'https://payment-service.example.com/remoteEntry.js');

                    // Load remote components
                    async function loadUserProfile() {
                    const UserProfile = await loader.loadRemoteModule('userService', 'UserProfile');
                    return new UserProfile();
                    }

                    async function loadPaymentForm() {
                    const PaymentForm = await loader.loadRemoteModule('paymentService', 'PaymentForm');
                    return new PaymentForm();
                    }

                    // Webpack Module Federation example
                    // webpack.config.js
                    const ModuleFederationPlugin = require('@module-federation/webpack');

                    module.exports = {
                    plugins: [
                    new ModuleFederationPlugin({
                    name: 'shell',
                    remotes: {
                    userMfe: 'userMfe@http://localhost:3001/remoteEntry.js',
                    paymentMfe: 'paymentMfe@http://localhost:3002/remoteEntry.js'
                    }
                    })
                    ]
                    };

                    // Usage in application
                    import('userMfe/UserProfile').then(({ UserProfile }) => {
                    const profile = new UserProfile();
                    profile.render();
                    });
                </div>

                <div class="demo-container">
                    <div class="demo-title">⚡ Dynamic Import Demo</div>
                    <button onclick="runDynamicImportDemo()">Run Dynamic Import</button>
                    <div id="dynamic-output" class="output" style="display: none;"></div>
                </div>
            </div>

            <div class="card">
                <h2>🛠️ Module Systems</h2>

                <div class="tabs">
                    <button class="tab active" onclick="showTab('bundlers')">Bundlers</button>
                    <button class="tab" onclick="showTab('nodejs')">Node.js</button>
                    <button class="tab" onclick="showTab('browser')">Browser</button>
                    <button class="tab" onclick="showTab('typescript')">TypeScript</button>
                </div>

                <div id="bundlers" class="tab-content active">
                    <h3>Module Bundlers</h3>
                    <div class="bundler-comparison">
                        <div class="bundler-card">
                            <h4>Webpack</h4>
                            <p>Powerful, configurable bundler with plugins</p>
                            <div class="code-block" data-language="JavaScript">
                                // webpack.config.js
                                module.exports = {
                                entry: './src/index.js',
                                output: {
                                path: __dirname + '/dist',
                                filename: 'bundle.js'
                                },
                                module: {
                                rules: [
                                {
                                test: /\.js$/,
                                use: 'babel-loader'
                                }
                                ]
                                }
                                };
                            </div>
                        </div>
                        <div class="bundler-card">
                            <h4>Vite</h4>
                            <p>Fast, modern build tool with HMR</p>
                            <div class="code-block" data-language="JavaScript">
                                // vite.config.js
                                export default {
                                build: {
                                rollupOptions: {
                                input: './src/main.js'
                                }
                                },
                                server: {
                                port: 3000
                                }
                                };
                            </div>
                        </div>
                        <div class="bundler-card">
                            <h4>Rollup</h4>
                            <p>Optimized for libraries and tree-shaking</p>
                            <div class="code-block" data-language="JavaScript">
                                // rollup.config.js
                                export default {
                                input: 'src/main.js',
                                output: {
                                file: 'dist/bundle.js',
                                format: 'esm'
                                }
                                };
                            </div>
                        </div>
                        <div class="bundler-card">
                            <h4>Parcel</h4>
                            <p>Zero-configuration bundler</p>
                            <div class="code-block" data-language="JavaScript">
                                // package.json
                                {
                                "scripts": {
                                "build": "parcel build src/index.html",
                                "dev": "parcel src/index.html"
                                }
                                }
                            </div>
                        </div>
                    </div>

                    <h3>Build Configuration</h3>
                    <div class="code-block" data-language="JavaScript">
                        // Advanced Webpack configuration
                        const path = require('path');
                        const HtmlWebpackPlugin = require('html-webpack-plugin');

                        module.exports = {
                        mode: 'production',
                        entry: {
                        main: './src/index.js',
                        vendor: './src/vendor.js'
                        },
                        output: {
                        path: path.resolve(__dirname, 'dist'),
                        filename: '[name].[contenthash].js',
                        clean: true
                        },
                        optimization: {
                        splitChunks: {
                        chunks: 'all',
                        cacheGroups: {
                        vendor: {
                        test: /[\\/]node_modules[\\/]/,
                        name: 'vendors',
                        chunks: 'all'
                        }
                        }
                        }
                        },
                        plugins: [
                        new HtmlWebpackPlugin({
                        template: './src/index.html'
                        })
                        ],
                        module: {
                        rules: [
                        {
                        test: /\.js$/,
                        exclude: /node_modules/,
                        use: {
                        loader: 'babel-loader',
                        options: {
                        presets: ['@babel/preset-env']
                        }
                        }
                        },
                        {
                        test: /\.css$/,
                        use: ['style-loader', 'css-loader']
                        }
                        ]
                        }
                        };
                    </div>
                </div>

                <div id="nodejs" class="tab-content">
                    <h3>Node.js Module System</h3>
                    <div class="code-block" data-language="JavaScript">
                        // package.json for ES modules
                        {
                        "type": "module",
                        "main": "index.js",
                        "exports": {
                        ".": "./index.js",
                        "./utils": "./utils.js",
                        "./helpers/*": "./helpers/*.js"
                        }
                        }

                        // CommonJS to ES modules migration
                        // Before (CommonJS)
                        const fs = require('fs');
                        const path = require('path');

                        module.exports = {
                        readFile: (filename) => {
                        return fs.readFileSync(path.join(__dirname, filename), 'utf8');
                        }
                        };

                        // After (ES modules)
                        import fs from 'fs';
                        import path from 'path';
                        import { fileURLToPath } from 'url';

                        const __dirname = path.dirname(fileURLToPath(import.meta.url));

                        export default {
                        readFile: (filename) => {
                        return fs.readFileSync(path.join(__dirname, filename), 'utf8');
                        }
                        };

                        // Conditional exports
                        // package.json
                        {
                        "exports": {
                        ".": {
                        "import": "./esm/index.js",
                        "require": "./cjs/index.js"
                        },
                        "./utils": {
                        "import": "./esm/utils.js",
                        "require": "./cjs/utils.js"
                        }
                        }
                        }

                        // Node.js built-in modules
                        import { readFile, writeFile } from 'fs/promises';
                        import { join, dirname } from 'path';
                        import { fileURLToPath } from 'url';
                        import { createServer } from 'http';

                        // Dynamic imports in Node.js
                        const modulePath = process.env.NODE_ENV === 'development'
                        ? './dev-config.js'
                        : './prod-config.js';

                        const config = await import(modulePath);
                    </div>
                </div>

                <div id="browser" class="tab-content">
                    <h3>Browser Module Support</h3>
                    <div class="code-block" data-language="HTML">
                        <!-- Native ES modules in browser -->
                        <script type="module">
                            import { utils } from './utils.js';
                            import { components } from './components.js';

                            // Top-level await
                            const data = await fetch('/api/data').then(r => r.json());

                            components.render(data);
                        </script>

                        <!-- Module with fallback -->
                        <script type="module" src="./modern.js"></script>
                        <script nomodule src="./legacy.js"></script>

                        <!-- Import maps -->
                        <script type="importmap">
{
    "imports": {
        "lodash": "./node_modules/lodash/lodash.js",
        "react": "./node_modules/react/index.js",
        "utils/": "./src/utils/"
    }
}
</script>

                        <script type="module">
                            import _ from 'lodash';
                            import React from 'react';
                            import { formatDate } from 'utils/date.js';
                        </script>
                    </div>

                    <div class="code-block" data-language="JavaScript">
                        // Service Worker with modules
                        // sw.js
                        import { precacheAndRoute } from 'workbox-precaching';
                        import { registerRoute } from 'workbox-routing';
                        import { StaleWhileRevalidate } from 'workbox-strategies';

                        precacheAndRoute(self.__WB_MANIFEST);

                        registerRoute(
                        ({ request }) => request.destination === 'image',
                        new StaleWhileRevalidate()
                        );

                        // Web Workers with modules
                        // worker.js
                        import { heavyComputation } from './compute.js';

                        self.addEventListener('message', async (event) => {
                        const { data } = event.data;
                        const result = await heavyComputation(data);
                        self.postMessage(result);
                        });

                        // Main thread
                        const worker = new Worker('./worker.js', { type: 'module' });
                        worker.postMessage({ data: [1, 2, 3, 4, 5] });
                        worker.onmessage = (event) => {
                        console.log('Result:', event.data);
                        };

                        // Module preloading
                        // Preload critical modules
                        const preloadModules = [
                        './core.js',
                        './components.js',
                        './utils.js'
                        ];

                        preloadModules.forEach(module => {
                        const link = document.createElement('link');
                        link.rel = 'modulepreload';
                        link.href = module;
                        document.head.appendChild(link);
                        });

                        // Progressive loading
                        async function loadApplication() {
                        // Load core modules first
                        const core = await import('./core.js');
                        core.init();

                        // Load secondary modules
                        const secondary = await Promise.all([
                        import('./features.js'),
                        import('./analytics.js')
                        ]);

                        secondary.forEach(module => module.default?.init?.());
                        }
                    </div>
                </div>

                <div id="typescript" class="tab-content">
                    <h3>TypeScript Modules</h3>
                    <div class="code-block" data-language="TypeScript">
                        // TypeScript module declarations
                        // types.ts
                        export interface User {
                        id: number;
                        name: string;
                        email: string;
                        }

                        export type UserRole = 'admin' | 'user' | 'guest';

                        export interface ApiResponse<T> {
                            data: T;
                            status: number;
                            message: string;
                            }

                            // userService.ts
                            import { User, UserRole, ApiResponse } from './types.js';

                            export class UserService {
                            private baseUrl: string;

                            constructor(baseUrl: string) {
                            this.baseUrl = baseUrl;
                            }

                            async getUser(id: number): Promise<ApiResponse<User>> {
                                const response = await fetch(`${this.baseUrl}/users/${id}`);
                                return response.json();
                                }

                                async createUser(userData: Omit<User, 'id'>): Promise<ApiResponse<User>> {
                                        const response = await fetch(`${this.baseUrl}/users`, {
                                        method: 'POST',
                                        headers: {
                                        'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify(userData)
                                        });
                                        return response.json();
                                        }
                                        }

                                        // Generic modules
                                        export class Repository<T> {
                                            private items: T[] = [];

                                            add(item: T): void {
                                            this.items.push(item);
                                            }

                                            find(predicate: (item: T) => boolean): T | undefined {
                                            return this.items.find(predicate);
                                            }

                                            getAll(): T[] {
                                            return [...this.items];
                                            }
                                            }

                                            // Module augmentation
                                            declare module './userService.js' {
                                            interface UserService {
                                            cache: Map<number, User>;
                                                getCachedUser(id: number): User | undefined;
                                                }
                                                }

                                                // Namespace modules
                                                export namespace Validation {
                                                export function validateEmail(email: string): boolean {
                                                const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                                                return regex.test(email);
                                                }

                                                export function validatePassword(password: string): boolean {
                                                return password.length >= 8;
                                                }
                                                }

                                                // tsconfig.json
                                                {
                                                "compilerOptions": {
                                                "target": "ES2020",
                                                "module": "ES2020",
                                                "moduleResolution": "node",
                                                "allowSyntheticDefaultImports": true,
                                                "esModuleInterop": true,
                                                "resolveJsonModule": true,
                                                "baseUrl": "./src",
                                                "paths": {
                                                "@/*": ["*"],
                                                "@/components/*": ["components/*"],
                                                "@/utils/*": ["utils/*"]
                                                }
                                                }
                                                }
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>🎯 Best Practices</h2>

                <h3>Module Organization</h3>
                <div class="code-block" data-language="JavaScript">
                    // Good module structure
                    // utils/index.js - Main entry point
                    export { formatDate, parseDate } from './date.js';
                    export { validateEmail, validatePassword } from './validation.js';
                    export { debounce, throttle } from './performance.js';
                    export { default as Logger } from './logger.js';

                    // utils/date.js - Specific functionality
                    export function formatDate(date, format = 'YYYY-MM-DD') {
                    // Implementation
                    }

                    export function parseDate(dateString) {
                    // Implementation
                    }

                    // utils/validation.js
                    export function validateEmail(email) {
                    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    return regex.test(email);
                    }

                    export function validatePassword(password) {
                    return password.length >= 8 && /[A-Z]/.test(password) && /[0-9]/.test(password);
                    }

                    // Single responsibility principle
                    // ❌ Bad - mixed concerns
                    export function processUserData(userData) {
                    // Validation
                    if (!userData.email) throw new Error('Email required');

                    // Formatting
                    userData.name = userData.name.trim();

                    // API call
                    return fetch('/api/users', {
                    method: 'POST',
                    body: JSON.stringify(userData)
                    });
                    }

                    // ✅ Good - separated concerns
                    // validation.js
                    export function validateUser(userData) {
                    if (!userData.email) throw new Error('Email required');
                    if (!userData.name) throw new Error('Name required');
                    return true;
                    }

                    // formatting.js
                    export function formatUser(userData) {
                    return {
                    ...userData,
                    name: userData.name.trim(),
                    email: userData.email.toLowerCase()
                    };
                    }

                    // api.js
                    export function createUser(userData) {
                    return fetch('/api/users', {
                    method: 'POST',
                    headers: {
                    'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(userData)
                    });
                    }
                </div>

                <h3>Performance Optimization</h3>
                <div class="code-block" data-language="JavaScript">
                    // Tree shaking optimization
                    // ❌ Bad - imports entire library
                    import _ from 'lodash';

                    // ✅ Good - imports only what's needed
                    import { debounce, throttle } from 'lodash';

                    // Or even better - specific imports
                    import debounce from 'lodash/debounce.js';
                    import throttle from 'lodash/throttle.js';

                    // Lazy loading for performance
                    const LazyComponent = React.lazy(() => import('./HeavyComponent.js'));

                    // Code splitting by route
                    const routes = [
                    {
                    path: '/dashboard',
                    component: React.lazy(() => import('./pages/Dashboard.js'))
                    },
                    {
                    path: '/profile',
                    component: React.lazy(() => import('./pages/Profile.js'))
                    }
                    ];

                    // Bundle analysis
                    // webpack-bundle-analyzer
                    npm install --save-dev webpack-bundle-analyzer

                    // webpack.config.js
                    const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

                    module.exports = {
                    plugins: [
                    new BundleAnalyzerPlugin({
                    analyzerMode: 'static',
                    openAnalyzer: false,
                    reportFilename: 'bundle-report.html'
                    })
                    ]
                    };

                    // Module preloading strategy
                    class ModulePreloader {
                    constructor() {
                    this.preloadedModules = new Set();
                    }

                    preload(modulePath) {
                    if (this.preloadedModules.has(modulePath)) {
                    return;
                    }

                    const link = document.createElement('link');
                    link.rel = 'modulepreload';
                    link.href = modulePath;
                    document.head.appendChild(link);

                    this.preloadedModules.add(modulePath);
                    }

                    preloadCritical() {
                    const criticalModules = [
                    './core.js',
                    './components/Header.js',
                    './components/Navigation.js'
                    ];

                    criticalModules.forEach(module => this.preload(module));
                    }
                    }

                    // Prefetch non-critical modules
                    const preloader = new ModulePreloader();
                    preloader.preloadCritical();

                    // Prefetch on user interaction
                    document.addEventListener('mouseover', (event) => {
                    if (event.target.matches('[data-prefetch]')) {
                    const modulePath = event.target.dataset.prefetch;
                    preloader.preload(modulePath);
                    }
                    });
                </div>

                <div class="demo-container">
                    <div class="demo-title">🎯 Best Practices Demo</div>
                    <button onclick="showBestPractices()">Show Best Practices</button>
                    <div id="practices-output" class="output" style="display: none;"></div>
                </div>
            </div>
        </div>

        <div class="best-practices">
            <h3>🚀 Module Best Practices</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div>
                    <h4>Organization</h4>
                    <ul>
                        <li>Use clear, descriptive file names</li>
                        <li>Group related functionality together</li>
                        <li>Create index files for clean imports</li>
                        <li>Follow single responsibility principle</li>
                        <li>Use consistent naming conventions</li>
                        <li>Organize by feature, not by file type</li>
                    </ul>
                </div>
                <div>
                    <h4>Performance</h4>
                    <ul>
                        <li>Use tree shaking to eliminate dead code</li>
                        <li>Implement code splitting for large apps</li>
                        <li>Lazy load non-critical modules</li>
                        <li>Preload critical modules</li>
                        <li>Use import maps for browser modules</li>
                        <li>Optimize bundle size with analysis tools</li>
                    </ul>
                </div>
                <div>
                    <h4>Maintainability</h4>
                    <ul>
                        <li>Write clear module documentation</li>
                        <li>Use TypeScript for better type safety</li>
                        <li>Avoid circular dependencies</li>
                        <li>Keep modules focused and small</li>
                        <li>Use absolute imports with path mapping</li>
                        <li>Implement proper error handling</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="highlight">
            <h3>🔮 Future of JavaScript Modules</h3>
            <p>
                <strong>Import Assertions:</strong> Specify module types with assert clauses for JSON, CSS, and
                more.<br>
                <strong>Module Blocks:</strong> Inline modules for Web Workers and dynamic module creation.<br>
                <strong>Top-level await:</strong> Use await at the module level without async functions.<br>
                <strong>Dynamic Import Maps:</strong> Runtime modification of import maps for flexible module
                resolution.<br>
                <strong>HTTP/2 Push:</strong> Server-side module preloading for optimal performance.
            </p>
        </div>
    </div>

    <script>
        // Tab functionality
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Show module structure
        function showModuleStructure() {
            const output = document.getElementById('structure-output');
            output.style.display = 'block';

            let result = '';

            result += 'Module Structure Example:\n\n';
            result += '// math.js\n';
            result += 'export const PI = 3.14159;\n';
            result += 'export function add(a, b) { return a + b; }\n';
            result += 'export function subtract(a, b) { return a - b; }\n\n';

            result += '// utils.js\n';
            result += 'export default function formatDate(date) {\n';
            result += '    return date.toLocaleDateString();\n';
            result += '}\n\n';

            result += '// main.js\n';
            result += 'import { add, PI } from "./math.js";\n';
            result += 'import formatDate from "./utils.js";\n\n';

            result += 'console.log(add(3, 5)); // 8\n';
            result += 'console.log(PI); // 3.14159\n';
            result += 'console.log(formatDate(new Date())); // Current date\n';

            output.textContent = result;
        }

        // Show import examples
        function showImportExamples() {
            const output = document.getElementById('import-output');
            output.style.display = 'block';

            let result = '';

            result += 'Import Examples:\n\n';
            result += '// Named imports\n';
            result += 'import { func1, func2 } from "./module.js";\n\n';

            result += '// Default import\n';
            result += 'import MyClass from "./MyClass.js";\n\n';

            result += '// Mixed imports\n';
            result += 'import MyClass, { func1, func2 } from "./module.js";\n\n';

            result += '// Namespace import\n';
            result += 'import * as Utils from "./utils.js";\n\n';

            result += '// Renamed imports\n';
            result += 'import { func1 as myFunc } from "./module.js";\n\n';

            result += '// Side-effect import\n';
            result += 'import "./polyfills.js";\n\n';

            output.textContent = result;
        }

        // Dynamic import demo
        function runDynamicImportDemo() {
            const output = document.getElementById('dynamic-output');
            output.style.display = 'block';

            let result = '';

            result += 'Dynamic Import Simulation:\n\n';

            // Simulate dynamic import
            result += '// Simulating dynamic import...\n';
            result += 'const module = await import("./heavy-module.js");\n';
            result += 'Status: Module loaded successfully ✓\n\n';

            result += '// Conditional loading...\n';
            const feature = Math.random() > 0.5 ? 'advanced' : 'basic';
            result += `Feature selected: ${feature}\n`;
            result += `Loading ${feature} module...\n`;
            result += `Status: ${feature} module loaded ✓\n\n`;

            result += '// Code splitting example:\n';
            result += 'Route: /dashboard\n';
            result += 'Loading dashboard module...\n';
            result += 'Status: Dashboard component ready ✓\n\n';

            result += '// Performance metrics:\n';
            result += 'Initial bundle size: 250KB\n';
            result += 'Lazy loaded: 150KB\n';
            result += 'Total loaded: 400KB\n';
            result += 'Time to interactive: 1.2s\n';

            output.textContent = result;
        }

        // Show best practices
        function showBestPractices() {
            const output = document.getElementById('practices-output');
            output.style.display = 'block';

            let result = '';

            result += 'Module Best Practices:\n\n';

            result += '✅ DO:\n';
            result += '• Use descriptive file names\n';
            result += '• Export only what\'s needed\n';
            result += '• Keep modules focused and small\n';
            result += '• Use index files for clean imports\n';
            result += '• Implement proper error handling\n';
            result += '• Use TypeScript for type safety\n\n';

            result += '❌ DON\'T:\n';
            result += '• Create circular dependencies\n';
            result += '• Import entire libraries unnecessarily\n';
            result += '• Mix different concerns in one module\n';
            result += '• Use deep relative imports\n';
            result += '• Forget to handle import errors\n';
            result += '• Skip module documentation\n\n';

            result += '🚀 Performance Tips:\n';
            result += '• Use tree shaking\n';
            result += '• Implement code splitting\n';
            result += '• Lazy load non-critical modules\n';
            result += '• Preload critical modules\n';
            result += '• Analyze bundle size regularly\n';

            output.textContent = result;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            console.log('ES6 Modules guide loaded');
        });
    </script>
</body>

</html>